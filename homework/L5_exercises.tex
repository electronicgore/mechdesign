%%% License: Creative Commons Attribution Share Alike 4.0 (see https://creativecommons.org/licenses/by-sa/4.0/)


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%----------------------------------------------------------------------------------------
%	PACKAGES AND OTHER DOCUMENT CONFIGURATIONS
%----------------------------------------------------------------------------------------

\documentclass[a4paper]{article}

\usepackage{amssymb}
\usepackage{enumerate}
\usepackage[usenames,dvipsnames]{color}
\usepackage{fancyhdr} % Required for custom headers
\usepackage{lastpage} % Required to determine the last page for the footer
\usepackage{extramarks} % Required for headers and footers
\usepackage[usenames,dvipsnames]{color} % Required for custom colors
\usepackage{graphicx} % Required to insert images
\usepackage{listings} % Required for insertion of code
\usepackage{courier} % Required for the courier font
\usepackage[table]{xcolor}
\usepackage{amsfonts,amsmath,amsthm,parskip,setspace,url}
\usepackage[section]{placeins}
\usepackage[a4paper]{geometry}
\usepackage[USenglish]{babel}
\usepackage[utf8]{inputenc}
\usepackage{tikz}


% Margins
\topmargin=-0.45in
\evensidemargin=0in
\oddsidemargin=0in
\textwidth=6.5in
\textheight=9.0in
\headsep=0.6in

\linespread{1.1} % Line spacing



%----------------------------------------------------------------------------------------
%   FORMATTING
%----------------------------------------------------------------------------------------
% Set up the header and footer
\pagestyle{fancy}
\lhead[c]{\textbf{{\color[rgb]{.5,0,0} K{\o}benhavns\\Universitet }}} % Top left header
\chead{\textbf{{\color[rgb]{.5,0,0} \Class }}\\ \hmwkTitle  } % Top center head
\rhead{\instructor \\ \theprofessor} % Top right header
\lfoot{\lastxmark} % Bottom left footer
\cfoot{} % Bottom center footer
\rfoot{Page\ \thepage\ of\ \protect\pageref{LastPage}} % Bottom right footer
\renewcommand\headrulewidth{0.4pt} % Size of the header rule
\renewcommand\footrulewidth{0.4pt} % Size of the footer rule


% Other formatting stuff
%\setlength\parindent{12pt}
\setlength{\parskip}{5 pt}
%\theoremstyle{definition} \newtheorem{ex}{\textbf{\Large{Exercise & #}\\}}
\usepackage{titlesec}
\titleformat{\section}[hang]{\normalfont\bfseries\Large}{Problem \thesection:}{0.5em}{}




%----------------------------------------------------------------------------------------
%	NAME AND CLASS SECTION
%----------------------------------------------------------------------------------------
\newcommand{\hmwkTitle}{Exercises for Lecture 5} % Assignment title
\newcommand{\Class}{Mechanism Design} % Course/class
\newcommand{\instructor}{Fall 2022} % TA
\newcommand{\theprofessor}{Prof. Egor Starkov} % Professor




%----------------------------------------------------------------------------------------
%   SOLUTIONS
%----------------------------------------------------------------------------------------
\newif\ifsolutions
\solutionstrue




\begin{document}

\begin{center}
		\LARGE\textbf{Exercises for Lecture 5:\\ gVCG, AGV.}
\end{center}


%
%\section{Transfers and Social choice}
%% MWG 21.B.3
%% social choice
%Consider a public good provision problem, with $k \in \{0,1\}$. The society consists of $N$ agents (for simplicity suppose $N$ is odd) with Euclidean preferences and valuations $(\theta_1, ..., \theta_N)$ for the public good (where $\theta_i$ can be positive or negative). The social cost of the public good is zero.
%
%\begin{enumerate}
%\item Show that a decision made via the majority voting is Pareto-optimal in the absence of transfers, but generically not Pareto-optimal if transfers are allowed.
%\item Compare and contrast the decision yielded by the majority rule (a ``median'') with the Pareto-optimal decision rule when transfers are allowed (a ``mean'').
%\end{enumerate}
%
%
%\ifsolutions
%\section*{Solution}
%Let $f_M(\theta)$ denote the social choice function corresponding to the majority voting procedure, and $f_T(\theta)$ denote the Pareto-optimal alternative in the presence of transfers. Then
%\begin{align*}
%f_M(\theta) &= \mathbb{I} \left\{ |Y(\theta)| > |N(\theta)| \right\},
%\\
%\text{where } Y(\theta) &\equiv \{ i \in N | \theta_i \geq 0 \},
%\\
%Z(\theta) &\equiv \{ i \in N | \theta_i < 0 \}.
%\end{align*}
%In words, $f_M(\theta)$ selects $k=1$ if and only if there are more agents preferring alternative $k=1$ (i.e., with $\theta_i \geq 0$) than agents preferring alternative $k=0$ (i.e., with $\theta_i < 0$). To show that this is Pareto-optimal in the absence of transfers, note that the only other option is to select (for some $\theta$) the opposite alternative $k=1-f(\theta)$. This would harm all agents $i \in Y(\theta)$, hence would not be a Pareto-improvement, hence $f(\theta)$ is Pareto-optimal.\footnote{Note that by this logic, any social choice rule is Pareto-optimal in this setting as long as it satisfies unanimity.}
%
%On the other hand, $f_T(\theta)$ is defined to be Pareto-optimal given transfers are alloweed. It is natural to restrict $\sum_{i=1}^{N} t_i = 0$ (or $\leq 0$), since otherwise distributing more transfers is always an improvement. Given this, it is immediate that $f_T(\theta) = \mathbb{I} \{\sum_{i=1}^N \theta_i \geq 0 \}$. This is because if the other $k$ is chosen for some $\theta$, then flipping a decision and redistributing transfers is an improvement.\footnote{If $\sum_{i=1}^N \theta_i \geq 0$ and $f(\theta)=0$ then flipping the decision and increasing every $i$'s transfer by $\theta_i - \varepsilon$ (which can be a negative amount for some $i$) strictly improves all agents' utility and balances the budget for some $\varepsilon > 0$. Conversely, if $\sum_{i=1}^N \theta_i < 0$ and $f(\theta)=1$ then flipping the decision and decreasing transfers by $\theta_i + \varepsilon$ is an improvement by similar logic.}
%
%In other words, treating $(\theta_1,...,\theta_N)$ as a statistical sample, $f_M(\theta)$ selects $k=1$ iff the \emph{median} $\theta_i$ is positive, whereas $f_T(\theta)$ selects $k=1$ whenever the \emph{mean} of all valuations is positive. While for some distributions the two can coincide (e.g., if $\theta_i \in \{-1,1\}$), in general they do not.
%
%Intuitively, the majority rule $f_M$ only counts the number of people in favor of either alternative, but it does not account for the intensity of preferences. Transfers can be used to account for this intensity, reallocating utility from agents with strong preferences to agents who are close to being indifferent between the two options.
%\fi 
%
%
%
%\section{Social choice with two alternatives}
%	Consider a social choice problem between two alternatives in $X = \{l, r\}$ (could be a ``left-leaning policy'' and a ``right-leaning policy'').
%	\begin{enumerate}
%		\item What \emph{ordinal} preferences (rankings $\succsim_i$) can an individual have over $X$?
%		\item Consider a society of two citizens, $i=1,2$ that can have any of the preferences you identified above.
%		\begin{enumerate}
%			\item Give an example of a social preference $\succsim$ that satisfies the three axioms from class (Full Domain, Unanimity, IIA).
%			\item Is it dictatorial? (Note that Arrow's theorem does not apply.)
%			\item Do there exist any other social preferences that satisfy the same requirements? Are any/all of them dictatorial?
%		\end{enumerate}
%		\item Now consider a society of three citizens, $i=1,2,3$. Give an example of a social preference that satisfies the three axioms (A1)-(A3) and is not dictatorial.
%	\end{enumerate}
%
%\ifsolutions
%\section*{Solution}
%	\begin{enumerate}
%		\item $l \succsim_i r$, $r \succsim_i l$, and $l \sim_i r$. If you restrict attention to strict rankings (as is sometimes done), then only $l \succ_i r$ and $r \succ_i l$ remain.
%		%For simplicity, we suppose from this point onwards either that preferences are strict (so $l \sim_i r$ never occurs), or that in case $l \sim_i r$ player $i$ randomly reports one of the two weak preferences. This is not necessary, and you can do the exercise with indifferences as well.
%		
%		\item For convenience, encode preferences using types $\theta_i \in \{l,r\}$ so that if $\theta_i=l$ then $l \succsim_i r$ and if $\theta_i=r$ then $r \succsim_i l$. For simplicity, suppose that if $l \sim_i r$ then $i$ randomly reports one of the two weak preferences.
%		Then all possible social preferences (ignoring indifferences) are given by the columns of the following table, where each cell indicates the socially preferred option:
%		\begin{center}
%		\begin{tabular}{c|c c c c c c c c c c c c c c c c|}
%			& \multicolumn{16}{c}{$\succsim_S$ (preferred option)}
%			\\
%			$(\theta_1,\theta_2)$ & 1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 & 9 & 10 & 11 & 12 & 13 & 14 & 15 & 16
%			\\ \hline 
%			$(l,l)$ & $l$ & $l$ & $l$ & $l$ & $r$ & $l$ & $l$ & $r$ & $l$ & $r$ & $r$ & $l$ & $r$ & $r$ & $r$ & $r$
%			\\
%			$(l,r)$ & $l$ & $l$ & $l$ & $r$ & $l$ & $l$ & $r$ & $l$ & $r$ & $l$ & $r$ & $r$ & $l$ & $r$ & $r$ & $r$
%			\\
%			$(r,l)$ & $l$ & $l$ & $r$ & $l$ & $l$ & $r$ & $l$ & $l$ & $r$ & $r$ & $l$ & $r$ & $r$ & $l$ & $r$ & $r$
%			\\
%			$(r,r)$ & $l$ & $r$ & $l$ & $l$ & $l$ & $r$ & $r$ & $r$ & $l$ & $l$ & $l$ & $r$ & $r$ & $r$ & $l$ & $r$
%			\\ \hline
%		\end{tabular}
%		\end{center}
%		Domain axiom (A1) can be satisfied by completing these social preferences in a non-contradictory way to cases when one of the agents reports indifference. E.g., if $l \sim_1 r$ and $l \geq_2 r$, then the resulting social preference $\succsim_S$ can be copied from either case $\theta=(l,l)$, or case $\theta=(r,l)$. 
%		
%		The IIA axiom (A3) has no bite in case of two alternatives, since if two profiles of individual preferences $\theta$ and $\theta'$ prescribe same rankings over alternatives for both players, then $\theta=\theta'$, so the requirement $\succsim_S(\theta)=\succsim_S(\theta')$ is satisfied trivially.
%		 
%		Out of the social preference rules presented in the table, only \#2,6,7 and 12 satisfy the unanimity axiom (A2), which requires that if $\theta=(l,l)$ then $l \succsim_S r$, and if $\theta=(r,r)$ then $r \succsim_S l$. You can see that \#6 and 7 are dictatorial, with player 1 and player 2 as dictators respectively. However, we also have non-dictatorial rules \#2 and 12. You can interpret them as unanimous voting with a default option: e.g., under \#2 alternative $r$ is only adopted if both players support it, and otherwise the society defaults to $l$.
%		
%		\item Majority voting (no need to call it pairwise, since there is only one pair of alternatives to rank) fits all the requirements. You could have come up with it on your own or you could have used the result from class -- note that with two alternatives, all individual preferences are necessarily single-peaked, with a peak at either $l$, or $r$.
%		
%	\end{enumerate}
%\fi



\section{Efficient public good provision (continued)}

Consider problem 2 from L3 problem set.

Assume now that players' valuations are distributed according to $\theta_i \sim U[-\hat{\theta},\hat{\theta}]$ for all $i$, and that the public project has some known social cost $c > 0$.

Derive the gVCG transfers.

\ifsolutions
\section*{Solution}
LCT for any $i$ is $\tilde{\theta}_i = -\hat{\theta}$ (you do not actually need to calculate the expectation to find it, since the expression that $\tilde{\theta}_i$ minimizes is weakly monotone in $\theta_i$ -- i.e., one of the edges of the support is the solution). The gVCG transfers are then given by
\begin{align*}
	t_i^{gVCG}(\theta) &= \max \left\{0, \sum_{j\neq i}\theta_j -\hat{\theta} - c \right\} - \left(\sum_{j\neq i}\theta_j -c\right) \cdot \mathbb{I} \left\{ \sum_{j=1}^N \theta_j - c > 0 \right\}
	\\
	&= \begin{cases}
		0	&	\text{ if } \sum_{j=1}^N \theta_j - c \leq 0,
		\\
		-\left(\sum_{j\neq i}\theta_j - c \right)	&	\text{ if }	\sum_{j\neq i} \theta_j - \hat{\theta} - c \leq 0 < \sum_{j=1}^N \theta_j - c,
		\\
		-\hat{\theta}	&	\text{ if } \sum_{j\neq i}\theta_j -\hat{\theta} - c > 0.
	\end{cases}
\end{align*}
\fi



\section{AGV and public goods}

Consider the public good provision problem (again). Suppose now that there are only two individuals: $i=1,2$, their valuations for the public project are $\theta_i \sim i.i.d. U[-1,1]$, and the cost is $c \in [0,1]$ (known to all agents).

\begin{enumerate}
	\item Calculate the AGV transfers for this problem.
	\item Do the players' payments to the mechanism cover the project cost $c$ if and only if the project is implemented? (I.e., is the mechanism exactly budget balanced once we account for the project costs?)
\end{enumerate}

\ifsolutions
\section*{Solution}
Note: the lectures are somewhat vague, so you can get somewhat different expressions in part 1 depending on how exactly you approach the problem. The answer to part 2 should, however, be qualitatively the same in all of those cases.

The $\tilde{t}$ are as follows: for $i=1,2$,
\begin{align*}
	\tilde{t}_i(\theta_i) &= \mathbb{E}_{\theta_j} \left[ (\theta_j - c) \cdot \mathbb{I} \{ \theta_1+\theta_2 \geq c \} \right]
	\\
	&= \int_{\min\{c-\theta_i, 1\}}^{1} (\theta_j -c) \frac{1}{2} d\theta_j 
	\\
	&= \frac{1}{4} \left[ (c-1)^2 - \theta_i^2 \right] \cdot \mathbb{I} \{ \theta_i \geq c-1 \};
\end{align*}
and the actual transfers are then $t_i^{AGV}(\theta) = \tilde{t}_j(\theta_j) - \tilde{t}_i(\theta_i)$ for $i=1,2$, which evaluates to 
\begin{align*}
	t_i^{AGV}(\theta) = \begin{cases}
		\frac{\theta_i^2 - \theta_j^2}{4} & \text{ if } \theta_i,\theta_j \geq c-1 \text{ (region I)},
		\\
		\frac{(c-1)^2 - \theta_j^2}{4} & \text{ if } \theta_j \geq c-1 > \theta_i \text{ (region II)},
		\\
		\frac{\theta_i^2 - (c-1)^2}{4} & \text{ if } \theta_i \geq c-1 > \theta_j \text{ (region III)},
		\\
		0 & \text{ if } c-1 > \theta_i,\theta_j \text{ (region IV)}.
	\end{cases}
\end{align*}
\begin{figure}
	\begin{center} 
		\begin{tikzpicture}[scale=3.5]
			%regions
			\filldraw[yellow, opacity=0.3] (-0.3,-0.3) -| (-1,1) -| (-0.3,-0.3);
			\filldraw[yellow, opacity=0.3] (-0.3,-0.3) -| (1,-1) -| (-0.3,-0.3);
			\filldraw[red, opacity=0.3] (-0.3,1) -| (1,1) -| (1,-0.3);
			\filldraw[red, opacity=0.2] (-0.3,1) -| (-0.3,-0.3) -| (1,-0.3);
			\filldraw[blue, opacity=0.3] (-0.3,-0.3) -| (-1,-1) -| (-0.3,-0.3);
			\draw (0.6,0.6) node{Ia};
			\draw (0.15,0.15) node{Ib};
			\draw (-0.6,0.35) node{II};
			\draw (0.35,-0.6) node{III};
			\draw (-0.6,-0.6) node{IV};
			
			% axes 
			\draw[->] (-1.1,0) -- (1.2,0) node[below]{$\theta_i$};
			\draw[->] (0,-1.1) -- (0,1.2) node[left]{$\theta_j$};
			\draw (0,0) node[below left]{$0$};
			\draw (0,1) node[below left]{$1$};
			\draw (0,-1) node[below left]{$-1$};
			\draw (1,0) node[below right]{$1$};
			\draw (-1,0) node[below left]{$-1$};
			
			\draw (-0.3,0) node[above ]{$c-1$};
			\draw (0,-0.3) node[right ]{$c-1$};
			\draw (0.7,0) node[below left]{$c$};
			\draw (0,0.7) node[below left]{$c$};
			
			% bounding box
			\draw[dotted] (1,-1) |- (-1,1) |- (1,-1);
			
			% lines
			\draw[dashed] (-0.3,1) -- (1,-0.3);
		\end{tikzpicture}
		\caption{regions for AGV transfers}
		\label{fig:AGV}
	\end{center}
\end{figure}

The regions are plotted in Figure \ref{fig:AGV}. Note that the public project is implemented only in region Ia, but the two agents' transfers sum up to zero there, same as in all other regions. Therefore, the AGV mechanism does not cover the project cost.
At this point you might think that this is because you need to compute $\tilde{t}_0$ and somehow include it in the players' payments. However, regardless of how you split this $\tilde{t}_0$ across agents, payments in regions Ia and Ib will always be continuous at the border (since $\tilde{t}_0$ would just add some constant to agents' payments), whereas to cover the cost of the project exactly, the sum of payments must be larger by $c$ in Ia than in Ib.
%\begin{align*}
%\tilde{t}_0 &= \mathbb{E}_{\theta_1,\theta_2} \left[ (\theta_1+\theta_2) \mathbb{I} \{ \theta_1+\theta_2 \geq c \} \right]
%\\
%&= \int_{c-1}^1 \left[ \int_{c-\theta_i}^1 (\theta_1+\theta_2) d\theta_2 \right] d\theta_1 
%\\
%&= \frac{4+c^3}{3}.
%\end{align*}
\fi 



\section{Myerson-Satterthwaite theorem}

Derive the gVCG transfers for the bilateral trade problem (assuming $\theta_b,\theta_s \sim U[0,1]$ and are mutually independent). Show that the resulting mechanism is not ex ante budget balanced (not even weakly).

\ifsolutions
\section*{Solution}

The seller's valuation for the item is given by his private type $\theta_S \sim U[0,1]$, and the buyer's valuation is given by his private type $\theta_B \sim U[0,1]$. The outside options are given by $\underline{U}_S({\theta}_S)={\theta}_S$ and $\underline{U}_B({\theta}_B)=0$ respectively. The utilities of the two players are Euclidean and are given by:
\begin{align*}
	u_S &= v(k,\theta_S)-t_S(\theta)=\theta_S (1-k)-t_S(\theta)
	\\
	u_B &= v(k,\theta_B)-t_B(\theta)=\theta_B k-t_B(\theta)
\end{align*}
where $k(\theta) \in [0,1]$ is the probability of trade given type profile $\theta$. It is straight-forward to see that the efficient allocation, $k^*$, is given by:
\begin{align*}
	k^*= \begin{cases}
		1 & \text{ if } \theta_S \leq \theta_B \\ 
		0 & \text{ if } \theta_S > \theta_B
	\end{cases}
\end{align*}
Our next step is to construct the gVCG transfers that implement the efficient allocation. They are given by:
\begin{align*}
	t_S^{gVCG} = v_B(k^*(\tilde{\theta}_S,\theta_B),\theta_B) + v_S(k^*(\tilde{\theta}_S,\theta_B),\tilde{\theta}_S) - \\
	-v_B(k^*(\theta_S,\theta_B),\theta_B) - \underline{U}_S(\tilde{\theta}_S)
	\\
	t_B^{gVCG} = v_S(k^*(\tilde{\theta}_B,\theta_S),\theta_S) + v_B(k^*(\tilde{\theta}_B,\theta_S),\tilde{\theta}_B) - \\
	-v_S(k^*(\theta_B,\theta_S),\theta_S) - \underline{U}_B(\tilde{\theta}_B)
\end{align*}
Noticing that $v_B(k^*(\theta))+v_S(k^*(\theta)) = \max \{\theta_B,\theta_S\}$ and plugging in the efficient allocation $k^*$ and the outside options $\underline{U}_i$, we get
\begin{align*}
	t_S^{gVCG} &= \max\{\tilde{\theta}_S,\theta_B\} - \theta_B k^*(\theta_S,\theta_B) - \tilde{\theta}_S
	\\
	t_B^{gVCG} &= \max\{\tilde{\theta}_B,\theta_S\} - \theta_S \left(1 - k^*(\theta_S,\theta_B)\right)
\end{align*}

The least charitable types $\tilde{\theta}_i$ of each player are defined as:
\begin{align*}
	\tilde{\theta}_i &\in \arg \min_{\theta_i \in \Theta_i} \left\{ \mathbb{E}_{\theta_{-i}} \left[ v_B (k^*(\theta_i,\theta_{-i}),\theta_j) + v_S (k^*(\theta_i,\theta_{-i}),\theta_j) - \underline{U}_i (\theta_i) \right] \right\}
	\\
	\Rightarrow \tilde{\theta}_B &\in \arg \min_{\theta_B \in [0,1]} \left\{ \mathbb{E}_{\theta_S} \left[ \max\{\theta_B,\theta_S\} \right] \right\} 
	= \arg \min_{\theta_B \in [0,1]} \left\{ \int_0^1 \max\{\theta_B,\theta_S\} \phi(\theta_S) d\theta_S \right\}
	\\
	&= \arg \min_{\theta_B \in [0,1]} \left\{ \int_0^{\theta_B} \theta_B d\theta_S + \int_{\theta_B}^1 \theta_S d\theta_S \right\}
	= \arg \min_{\theta_B \in [0,1]} \left\{ \theta_B^2 +  \frac{1-\theta_B^2}{2} \right\}	
	\\
	&= \{ 0 \};
	\\
	\tilde{\theta}_S &\in \arg \min_{\theta_S \in [0,1]} \left\{ \mathbb{E}_{\theta_B} \left[ \max\{\theta_B,\theta_S\} - \theta_S \right] \right\} = \arg \min_{\theta_S \in [0,1]} \left\{ \frac{1}{2} + \frac{\theta_S^2}{2} - \theta_S \right\} = \{1\}.
\end{align*}
So in the end we have $\tilde{\theta}_B = 0$, $\tilde{\theta}_S = 1$. Plugging these into the respective expressions for transfers, we get the following (because $\max\{\tilde{\theta}_S,\theta_B\} = \max\{1,\theta_B\} = 1$, and $\max\{\tilde{\theta}_B,\theta_S\} = \max\{0,\theta_S\} = \theta_S$):
\begin{align*}
	t_S^{gVCG} &= - \theta_B k^*(\theta_S,\theta_B)
	\\
	t_B^{gVCG} &= \theta_S k^*(\theta_S,\theta_B)
\end{align*}
Recall that BB (budget balance) is defined as $t_S+t_B\geq0$. The sum of gVCG transfers is:
\begin{align*}
	t_S+t_B= \begin{cases}
		\theta_S - \theta_B <0 & \text{ if } \theta_S \leq \theta_B, 
		\\ 
		0 & \text{ if } \theta_S > \theta_B.
	\end{cases}
\end{align*}
Hence, we have now shown that the gVCG mechanism is not budget balanced (ex ante or ex post). However, it is the mechanism that yields the highest expected revenue $\mathbb{E}_\theta \left(t_S(\theta) + t_B(\theta)\right)$ among all mechanisms that are efficient, BIC, and interim IR. Therefore, there does not exist a mechanism for the bilateral trade problem which is efficient, BIC, interim IR, and ex ante BB.

\fi



\section{Auction with non-trivial seller valuation}
%Note: zero o.o. for seller confuses students. This is on purpose.
%Note: there is a clash of notation, with vj denoting valuations and not real utilities as in lectures.
A seller, $i=1$, possesses a single indivisible object for which there are two potential buyers. Each buyer $i \in \{2,3\}$ has value $v_i$ for the good and the seller has an opportunity cost $c$ from selling the good.  Utility is quasi-linear in money, so if buyer $i$ purchases the good at price $p$, his final utility is $v_i-p$, and the seller's utility is $p-c$. Each agent has zero utility if he does not trade and zero is therefore also the reservation utility of each agent.

Each $v_i$ is drawn independently from the same distribution $F$ which has full support on $[0,\bar v]$, and $c$ is drawn independently from a distribution $G$ which has support $[0,\bar c]$.  Assume that $F$ and $G$ satisfy all of the conditions necessary for the revenue
equivalence theorem and our characterization results in class.

\medskip
A mechanism consists of two collections of functions, $q(c, v_2, v_3)$ and $t(c, v_2, v_3)$, where $q(c, v_2, v_3)$ is a probability distribution that prescribes the probabilities that the good will be allocated to each of the three agents, and $t(c, v_2, v_3)$ gives the list of transfers paid by each of the three agents.
Say that a mechanism is \emph{feasible} if it is Bayesian incentive compatible, interim individually rational, and ex ante exactly budget-balanced.
%TODO: using Borgers' prop 3.6, can strengthen this back to ex post BB. This also makes more sense in the context of the problem formulation which implies the same prices for buyer and seller.

\begin{enumerate}
	\item What is the efficient allocation rule?
	
	\item Assume $\bar c = \bar v$.  Show that there does not exist a feasible mechanism that implements the efficient allocation rule. \emph{Hint: use gVCG and its properties.}
	
	\item Now assume $\bar v > \bar c$.  Show that the following is a sufficient condition for the existence of a feasible mechanism that implements the efficient allocation rule:
	$$ \mathbb{E}(\min\{v_2, v_3\}) \geq \bar c. $$
	\item Again assume $\bar{v} > \bar{c}$, but now suppose that there are $N$ potential buyers with values drawn independently from $F$.  Prove that for any $F$ and $G$ there is a $\bar N$ such that whenever $N > \bar{N}$  there exists a feasible mechanism that
	implements the efficient allocation rule.
\end{enumerate}


\ifsolutions
\section*{Solution}
Note: this problem has not been brought in conformance with the notation we use in class (allocations are $q$ instead of $k$, valuations are $v_i$ instead of $\theta_i$, conflicting with our notation for real utilities $v_i(k,\theta_i)$, it mentions both prices $p$ and transfers $t$...) This adds an extra layer of complexity that tests your skills in parsing text and context, rather than notation.

This solution uses the following notation: $a \vee b \equiv \max\{a,b\}$; $a \wedge b \equiv \min \{a,b\}$.
\begin{enumerate}%[\label=(\alph{enumi})]
	\item The efficient allocations must satisfy
	\begin{align*}
		q(c, v_2, v_3) = 
		\begin{cases}
			(1,0,0) &\text{ if } c > v_2, v_3, \\
			(0,1,0) &\text{ if } v_2 > c,v_3, \\
			(0,0,1) &\text{ if } v_3 > c,v_2.
		\end{cases}
	\end{align*}
	Ties can be broken arbitrarily.
	
	\item Let's use the Krishna--Perry theorem. The least charitable types are $0$ for the buyers and $\bar{c}$ for the seller (see problem 3).\footnote{This problem is more complex due to two buyers instead of one, but the idea is the same. Further, while you cannot compute the expectation $\mathbb{E}_{\theta_{-i}} [\sum v_i(k^*(\theta),\theta_i)]$ in this problem -- since distributions $F$ and $G$ are not specified, -- you can still see that, e.g., when you try to compute B2's LCT $\tilde{v}_2 \in \arg \min_{v_2} \left\{ \mathbb{E}_{c,v_3} \left[ \max\{c,v_2,v_3\} \right] \right\}$ the expression inside the expectation is weakly decreasing in $v_2$ for all $c,v_3$, hence the whole expectation is also weakly decreasing, so it is minimized by $v_2 = 0$.} 
	The gVCG mechanism has the following transfers:
	%
	\begin{itemize}
		
		\item when no trade occurs, there are no transfers
		
		\item when trade occurs between the seller and buyer $i$, $i$ pays $v_{-i} \vee c$, the seller receives $v_i \wedge \bar{c}$, and $-i$ has transfer zero.
		%\footnote{This solution uses the following notation: $a \vee b \equiv \max \{a,b\}$ and $a \wedge b \equiv \min \{a,b\}$.}
		
	\end{itemize}
	
	%When $c=0$ and $v_i > v_{-i}$, trade occurs, with the buyer paying $v_{-i} < \bar{v} =\bar{c}$ and the seller receiving $\bar{c}$. So there is a budget deficit.
	If $\bar{v}=\bar{c}$ then $v_i \wedge \bar{c} = v_i$, so this mechanism yields weakly negative revenue: %assuming wlog that $v_i > v_{-i}$, we get
	\begin{align*}
		\sum_i t_i (\theta) = \begin{cases}
			0 &\text{ if } c > v_2, v_3 \\
			v_3 \vee c - v_2 < 0 &\text{ if } v_2 > c,v_3 \\
			v_2 \vee c - v_3 < 0 &\text{ if } v_3 > c,v_2.
		\end{cases}
	\end{align*}
	
	Since gVCG mechanism has maximal revenue among efficient, BIC and IIR mechanisms, this implies that any other mechanism that is efficient, BIC, and interim IR will run an expected deficit. If there is no ex ante BB mechanism then there is no ex post BB mechanism either (deficit in expectation means that there must be deficit for at least some type realizations). Therefore, no feasible mechanism exists in this case.
	
	
	\item Let's use the same mechanism. The budget surplus is zero conditional on no trade, and
	%
	\begin{equation*}
		[ v_2 \wedge v_3 ] \vee c - [ v_2 \vee v_3 ] \wedge \bar{c}
		\geq [ v_2 \wedge v_3 ] - \bar{c} 
	\end{equation*}
	%
	conditional on trade. So the expected budget surplus is bounded below by
	%
	\begin{equation*}
		\mathbb{E}( [ v_2 \wedge v_3 ] - \bar{c} | v_2 \vee v_3 \geq c )
		\geq \mathbb{E}( [ v_2 \wedge v_3 ] - \bar{c} )
		\geq 0 .
	\end{equation*}
	
	So the gVCG mechanism runs an expected budget surplus, and we can make the mechanism exactly ex ante budget balanced by distributing the expected revenue among players.
	
	
	\item By analogous reasoning, the expected budget surplus is bounded below by
	\begin{equation*}
		\mathbb{E}\left( v^{(2)} - \bar{c} \right),
	\end{equation*}
	where $v^{(2)}$ is the second order statistic (the second-highest value). Since $v \in (\bar{c},\bar{v})$ with positive probability under $F$, the expected value $\mathbb{E} v^{(2)}$ can be made arbitrarily close to $\bar{v}$ by taking $N$ large enough; in particular, $N$ can be chosen large enough to make it higher than $\bar{c}$.
\end{enumerate}
\fi



%%-----------------------------------------------------------------------------------------------------

\end{document}
