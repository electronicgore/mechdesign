%%% License: Creative Commons Attribution Share Alike 4.0 (see https://creativecommons.org/licenses/by-sa/4.0/)


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%----------------------------------------------------------------------------------------
%	PACKAGES AND OTHER DOCUMENT CONFIGURATIONS
%----------------------------------------------------------------------------------------

\documentclass{article}

\usepackage{enumitem}
\usepackage[usenames,dvipsnames]{color}
\usepackage{fancyhdr} % Required for custom headers
\usepackage{lastpage} % Required to determine the last page for the footer
\usepackage{extramarks} % Required for headers and footers
\usepackage[usenames,dvipsnames]{color} % Required for custom colors
\usepackage{graphicx} % Required to insert images
\usepackage{listings} % Required for insertion of code
\usepackage{courier} % Required for the courier font
\usepackage[table]{xcolor}
\usepackage{amsfonts,amsmath,amsthm,amssymb,parskip,setspace,url}
\usepackage[section]{placeins}
\usepackage[a4paper]{geometry}
\usepackage[USenglish]{babel}
\usepackage[utf8]{inputenc}


% Margins
\topmargin=-0.45in
\evensidemargin=0in
\oddsidemargin=0in
\textwidth=6.5in
\textheight=9.0in
\headsep=0.6in

\linespread{1.1} % Line spacing

%----------------------------------------------------------------------------------------
%	DOCUMENT STRUCTURE COMMANDS
%	Skip this unless you know what you're doing
%----------------------------------------------------------------------------------------

% Header and footer for when a page split occurs within a problem environment
\newcommand{\enterProblemHeader}[1]{
\nobreak\extramarks{#1}{#1 continued on next page\ldots}\nobreak
\nobreak\extramarks{#1 (continued)}{#1 continued on next page\ldots}\nobreak
}

% Header and footer for when a page split occurs between problem environments
\newcommand{\exitProblemHeader}[1]{
\nobreak\extramarks{#1 (continued)}{#1 continued on next page\ldots}\nobreak
\nobreak\extramarks{#1}{}\nobreak
}

\setcounter{secnumdepth}{0} % Removes default section numbers
\newcounter{homeworkProblemCounter} % Creates a counter to keep track of the number of problems

\newcommand{\homeworkProblemName}{}
\newenvironment{ex}[1][Problem \arabic{homeworkProblemCounter}]{ % Makes a new environment called homeworkProblem which takes 1 argument (custom name) but the default is "Problem #"
\stepcounter{homeworkProblemCounter} % Increase counter for number of problems
\renewcommand{\homeworkProblemName}{#1} % Assign \homeworkProblemName the name of the problem
\section{\homeworkProblemName} % Make a section in the document with the custom problem count
%\enterProblemHeader{\homeworkProblemName} % Header and footer within the environment
}{
%\exitProblemHeader{\homeworkProblemName} % Header and footer after the environment
}

\newcommand{\problemAnswer}[1]{ % Defines the problem answer command with the content as the only argument
\noindent\framebox[\columnwidth][c]{\begin{minipage}{0.98\columnwidth}#1\end{minipage}} % Makes the box around the problem answer and puts the content inside
}

\newcommand{\homeworkSectionName}{}
\newenvironment{homeworkSection}[1]{ % New environment for sections within homework problems, takes 1 argument - the name of the section
\renewcommand{\homeworkSectionName}{#1} % Assign \homeworkSectionName to the name of the section from the environment argument
\subsection{\homeworkSectionName} % Make a subsection with the custom name of the subsection
%\enterProblemHeader{\homeworkProblemName\ [\homeworkSectionName]} % Header and footer within the environment
}{
%\enterProblemHeader{\homeworkProblemName} % Header and footer after the environment
}

\newcommand{\join}{\vee}

\newcommand{\meet}{\wedge}

\newif\ifsolutions

%----------------------------------------------------------------------------------------
%----------------------------------------------------------------------------------------
%----------------------------------------------------------------------------------------
% Set up the header and footer
\pagestyle{fancy}
\lhead[c]{\textbf{{\color[rgb]{.5,0,0} K{\o}benhavns\\Universitet }} \firstxmark} % Top left header
\chead{\textbf{{\color[rgb]{.5,0,0} \Class }}\\ \hmwkTitle  } % Top center head
\rhead{\instructor \\ \theprofessor} % Top right header
\lfoot{\lastxmark} % Bottom left footer
\cfoot{} % Bottom center footer
\rfoot{Page\ \thepage\ of\ \protect\pageref{LastPage}} % Bottom right footer
\renewcommand\headrulewidth{0.4pt} % Size of the header rule
\renewcommand\footrulewidth{0.4pt} % Size of the footer rule

\setlength\parindent{12pt} % Removes all indentation from paragraphs







%----------------------------------------------------------------------------------------
%	NAME AND CLASS SECTION
%----------------------------------------------------------------------------------------

\newcommand{\hmwkTitle}{Exercises: Lec 4} % Assignment title
\newcommand{\Class}{Mechanism Design} % Course/class
\newcommand{\instructor}{Fall 2019} % TA
\newcommand{\theprofessor}{Prof. Egor Starkov} % Professor

%\theoremstyle{definition} \newtheorem{ex}{\textbf{\Large{Exercise & #}\\}}
\setlength{\parskip}{5 pt}




















%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\solutionsfalse
\solutionstrue
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\begin{document}
	
	
\ifsolutions
	\begin{center}
		
		{\Huge Problem Set for Lecture 4
			(with Solutions)}
	\end{center}
	
	\emph{The solutions are brought to you by Hannah Barth and Inga Reymann. Notes in cursive added by Egor.}
\fi
	
These exercises are for your own practice and are not to be handed in. Some exercises are open ended in that they may not have a unique correct answer. If you think there is a typo in the problem, attempt to amend it and proceed as best you can.

%%------------------------------------------------------------------------------------------------

\begin{ex}[Review Questions]
	\begin{itemize}
		\item How do you solve a monopolistic screening problem?
		\item Explain the meaning of the virtual surplus. What is it composed of?
		\item For which types are allocations distorted in the optimal mechanism? For which not?
	\end{itemize}
	
\end{ex}



%%------------------------------------------------------------------------------------------------

\begin{ex}
	% NU 410-3 2019, ps6 q3
	Consider a symmetric setting to the one discussed in lecture: a seller has an item of some privately known quality $\theta \sim U[0,1]$. Here $\theta$ is the seller's valuation of the item, and the buyer's valuation is given by $v(\theta) > \theta$. The buyer designs a direct mechanism $(k,t)$ to purchase this item, where $k(\theta)$ is the probability of trade and $t(\theta)$ is the payment from the buyer to the seller. Players' expected utilities given true type $\theta$ and seller's report $\hat{\theta}$ are then given by
	\begin{align*}
		U^S(\hat{\theta}|\theta) &= -\theta k(\hat{\theta}) + t(\hat{\theta}),
		\\
		U^B(\hat{\theta}|\theta) &= v(\theta) k(\hat{\theta}) - t(\hat{\theta}).
	\end{align*}
	\begin{enumerate}
		\item Retrace the steps from lecture and show that the buyer's expected utility given $k$ and incentive compatible transfers is given by:
		\begin{align*}
			\mathbb{E} U^B(\theta | \theta) = \int_0^1 k(\theta) VS(\theta) \phi(\theta) d\theta - U^S(1),
		\end{align*}
		where $VS(\theta) = v(\theta) - \theta - \frac{F(\theta)}{\phi(\theta)}$.
		\item Explain each component of $VS(\theta)$.
		\item Find the optimal allocation when $v(\theta) = \frac{3\theta}{2}$ for $\theta \in [0,\frac{1}{3}]$ and $v(\theta) = \frac{5\theta}{2}-\frac{1}{3}$ for $\theta \in [\frac{1}{3},1]$.
		\item Find the optimal allocation when $v(\theta) = \frac{5\theta}{2}$ for $\theta \in [0,\frac{1}{3}]$ and $v(\theta) = \frac{3\theta}{2}+\frac{1}{3}$ for $\theta \in [\frac{1}{3},1]$.
	\end{enumerate}
	
\ifsolutions
\section*{Solution}
\paragraph{1}

The expected utility of the buyer can be written as:
$$ \mathbb{E}U^B(\hat{\theta}|\theta)=\mathbb{E}_\theta[v(\theta)k(\hat{\theta})-t(\hat{\theta})]$$

Rearranging $U^S$ to $t(\theta)=U^S(\hat{\theta}|\theta)+\theta k(\theta)$ and plugging it into the expected utility of the buyer:

$$ \mathbb{E}U^B(\theta)=\mathbb{E}_\theta[v(\theta)k(\theta)-U^S(\theta)-\theta k(\theta)]$$

Now, using the envelope theorem yields:
\begin{align*}
	\mathbb{E}U^B(\theta) &=\mathbb{E}_\theta[(v(\theta)-\theta)k(\theta)-U^S(1)-\int_\theta^1k(s)ds]
	\\
	&=\mathbb{E}_\theta[(v(\theta)-\theta)k(\theta)-\int_\theta^1k(s)ds]-U^S(1)
	\\
	&=\int_0^1 \left[(v(\theta)-\theta)k(\theta)-\int_\theta^1k(s)ds \right] \phi(\theta)d\theta-U^S(1)
	\\
	&=\int_0^1(v(\theta)-\theta)k(\theta)\phi(\theta)d\theta  -\int_0^1\int_\theta^1k(s) \phi(\theta) ds d\theta-U^S(1)
	\\
	&=\int_0^1(v(\theta)-\theta)k(\theta)\phi(\theta)d\theta  -\int_0^1\int_0^\theta k(s) \phi(\theta) d\theta ds-U^S(1)
	\\
	&=\int_0^1(v(\theta)-\theta)k(\theta)\phi(\theta)d\theta  -\int_0^1 k(s) \left[\int_0^\theta \phi(\theta) d\theta \right] ds-U^S(1)
	\\
	&=\int_0^1(v(\theta)-\theta)k(\theta)\phi(\theta)d\theta-\int_0^1 k(\theta) F(\theta) d\theta -U^{S}(1)
	\\
	&=\int_0^1 \left(v(\theta)-\theta-\frac{F(\theta)}{\phi(\theta)} \right) k(\theta)\phi(\theta)d\theta -U^S(1)
\end{align*}


\paragraph{2}

Explain each component of $VS(\theta)$.

$$ VS(\theta)=v(\theta)-\theta-\frac{F(\theta)}{\phi(\theta)} $$

$VS(\theta)$ is the virtual surplus gained by the buyer in this model. $v(\theta)$ is the buyer's valuation, $\theta$ is the seller's valuation which is equal to the quality of the item which is privately known by the seller. The buyer does not know $\theta$ exactly, but he assumes that $\theta$ is a random variable with some cumulative distribution function $F(\theta)$ and probability distribution function $\phi(\theta)$.

\emph{Term $v(\theta) - \theta$ represents the \textbf{surplus} generated by trade, this is what the buyer would maximize if he could extract the information about $\theta$ from the seller at no cost. The term $\frac{F(\theta)}{\phi(\theta)}$ is the \textbf{information rent} that must be left to the seller in order to incentivize truthtelling. The buyer thus maximizes surplus net of information rents.}

\paragraph{3}

Calculate virtual surplus $VS(\theta) = v(\theta) - \theta - \frac{F(\theta)}{f(\theta)}$: 
\begin{align*}
VS(\theta) &= 
\begin{cases}
\frac{3\theta}{2} - \theta - \frac{\theta}{1} &\text{ if } \theta \in [0, \frac{1}{3}]
\\
\frac{5\theta}{2} - \frac{1}{3} - \theta - \frac{\theta}{1} &\text{ if } \theta \in [0, \frac{1}{3}]
\end{cases}
\\
\Leftrightarrow
VS(\theta) &= 
\begin{cases}
-\frac{\theta}{2} &\text{ if } \theta \in [0, \frac{1}{3}]
\\
\frac{\theta}{2} - \frac{1}{3} &\text{ if } \theta \in [0, \frac{1}{3}]
\end{cases}
\end{align*}
Pointwise optimization prescribes setting $q(\theta) = 1$ if $VS(\theta) \geq 0$ and $q(\theta) = 0$ otherwise. In this problem this would result in allocation $q(\theta) = \mathbb{I} \left\{ \theta \geq \frac{2}{3} \right\}$, \emph{which is not weakly decreasing as monotonicity requires.\footnote{Note that in this inverted problem, seller's IC requires that allocation $k$ is \emph{decreasing} in $\theta$ rather than increasing.} Therefore, let us look at constant allocations $q(\theta) = \bar{q}$ instead. By linearity of buyer's payoff in $\bar{q}$ in that case, one of $\bar{q} \in \{0,1\}$ must be optimal.}

\emph{Allocation rule corresponding to $\bar{q} = 0$ prescribes no trade w.p. 1, hence buyer's payoff is zero. Allocation rule $\bar{q} = 1$ prescribes trade w.p. 1 at a constant price, hence this price must be $\bar{t} = \max \theta$ for all seller types to be willing to sell. Buyer's expected payoff is then equal to }
\begin{align*}
\mathbb{E} \left[ v(\theta) - 1 \right] &= \int_0^{\frac{1}{3}} \frac{3\theta}{2} d\theta + \int_{\frac{1}{3}}^{1} \left[ \frac{5 \theta}{2} - \frac{1}{3} \right] d\theta -1 = \frac{35}{36} - 1 < 0,
\end{align*}
\emph{hence no trade ($q(\theta) = 0$ for all $\theta$) is optimal.}
	

\paragraph{4}	
 In this case we have
\begin{align*}
VS(\theta) &= 
\begin{cases}
\frac{\theta}{2} &\text{ if } \theta \in [0, \frac{1}{3}]
\\
-\frac{\theta}{2} + \frac{1}{3} &\text{ if } \theta \in [0, \frac{1}{3}]
\end{cases}
\end{align*}
Pointwise maximization yields $q(\theta) = \mathbb{I} \left\{ \theta \leq \frac{2}{3} \right\}$. \emph{Monotonicity is not violated (the allocation is weakly decreasing in $\theta$), hence this allocation is implementable.}
\fi
\end{ex}






%%------------------------------------------------------------------------------------------------

\end{document}
